<div class="bg-white rounded-2xl p-6 border border-gray-100 shadow-sm h-full flex flex-col">
    <div class="flex items-center justify-between mb-6 flex-wrap gap-4">
        <div>
            <h3 class="text-lg font-semibold text-gray-900">Sales Analytics</h3>
            <p class="text-sm text-gray-500">Revenue vs Orders over time</p>
        </div>
        <div class="flex gap-2">
            <!-- Period Selector -->
            <select 
                [ngModel]="currentPeriod()"
                (ngModelChange)="setPeriod($event)"
                class="px-3 py-1.5 text-xs font-medium rounded-lg border border-gray-200 bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                @for (period of periods; track period.value) {
                    <option [value]="period.value">{{ period.label }}</option>
                }
            </select>
            
            <!-- Chart Type Toggle -->
            <button (click)="setChartType('revenue')"
                class="px-3 py-1.5 text-xs font-medium rounded-lg transition-colors"
                [class.bg-indigo-600]="activeChart() === 'revenue'" 
                [class.text-white]="activeChart() === 'revenue'"
                [class.bg-gray-100]="activeChart() !== 'revenue'"
                [class.text-gray-600]="activeChart() !== 'revenue'">
                Revenue
            </button>
            <button (click)="setChartType('orders')"
                class="px-3 py-1.5 text-xs font-medium rounded-lg transition-colors"
                [class.bg-indigo-600]="activeChart() === 'orders'" 
                [class.text-white]="activeChart() === 'orders'"
                [class.bg-gray-100]="activeChart() !== 'orders'"
                [class.text-gray-600]="activeChart() !== 'orders'">
                Orders
            </button>
        </div>
    </div>
    
    @if (isLoading()) {
        <div class="h-64 flex items-center justify-center">
            <div class="text-center">
                <i class="bi bi-arrow-repeat animate-spin text-3xl text-indigo-600"></i>
                <p class="text-gray-500 mt-2 text-sm">Loading chart data...</p>
            </div>
        </div>
    } @else if (hasError()) {
        <div class="h-64 flex items-center justify-center">
            <div class="text-center">
                <div class="w-16 h-16 bg-red-100 rounded-2xl flex items-center justify-center mx-auto mb-4">
                    <i class="bi bi-exclamation-triangle text-2xl text-red-600"></i>
                </div>
                <p class="text-gray-600 font-medium mb-1">Failed to load chart</p>
                <p class="text-gray-400 text-sm mb-4">There was an error rendering the chart</p>
                <button (click)="retryChart()" 
                    class="px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors">
                    <i class="bi bi-arrow-clockwise mr-2"></i>
                    Retry
                </button>
            </div>
        </div>
    } @else {
        <div class="h-64 relative">
            <canvas #chartCanvas></canvas>
        </div>
    }
</div>
