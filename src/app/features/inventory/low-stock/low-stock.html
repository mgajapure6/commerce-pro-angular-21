<div class="min-h-screen bg-gray-50/50 p-4 sm:p-6 lg:p-8">
    <div class="max-w-[1600px] mx-auto space-y-6">

        <!-- Header -->
        <div
            class="flex flex-col lg:flex-row lg:items-center justify-between gap-4 bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
            <div>
                <div class="flex items-center gap-3">
                    <h1 class="text-2xl font-bold text-gray-900">Low Stock Alerts</h1>
                    @if (stats().unreadAlerts > 0) {
                    <span class="px-3 py-1 bg-red-100 text-red-700 text-sm font-medium rounded-full animate-pulse">
                        {{ stats().unreadAlerts }} new
                    </span>
                    }
                </div>
                <p class="text-gray-500 mt-1 text-sm">Monitor inventory levels, manage reorder points, and automate
                    purchase decisions</p>
            </div>
            <div class="flex flex-wrap items-center gap-3">
                <button (click)="setView('dashboard')"
                    class="px-4 py-2.5 rounded-xl text-sm font-medium transition-all flex items-center gap-2"
                    [class.bg-indigo-600]="activeView() === 'dashboard'"
                    [class.text-white]="activeView() === 'dashboard'" [class.bg-white]="activeView() !== 'dashboard'"
                    [class.text-gray-700]="activeView() !== 'dashboard'" [class.border]="activeView() !== 'dashboard'"
                    [class.border-gray-200]="activeView() !== 'dashboard'"
                    [class.shadow-sm]="activeView() !== 'dashboard'">
                    <i class="bi bi-speedometer2"></i>
                    Dashboard
                </button>
                <button (click)="setView('alerts')"
                    class="px-4 py-2.5 rounded-xl text-sm font-medium transition-all flex items-center gap-2"
                    [class.bg-indigo-600]="activeView() === 'alerts'" [class.text-white]="activeView() === 'alerts'"
                    [class.bg-white]="activeView() !== 'alerts'" [class.text-gray-700]="activeView() !== 'alerts'"
                    [class.border]="activeView() !== 'alerts'" [class.border-gray-200]="activeView() !== 'alerts'"
                    [class.shadow-sm]="activeView() !== 'alerts'">
                    <i class="bi bi-bell"></i>
                    Alerts
                    @if (stats().unreadAlerts > 0) {
                    <span class="bg-red-500 text-white text-xs px-1.5 py-0.5 rounded-full">{{ stats().unreadAlerts
                        }}</span>
                    }
                </button>
                <button (click)="setView('items')"
                    class="px-4 py-2.5 rounded-xl text-sm font-medium transition-all flex items-center gap-2"
                    [class.bg-indigo-600]="activeView() === 'items'" [class.text-white]="activeView() === 'items'"
                    [class.bg-white]="activeView() !== 'items'" [class.text-gray-700]="activeView() !== 'items'"
                    [class.border]="activeView() !== 'items'" [class.border-gray-200]="activeView() !== 'items'"
                    [class.shadow-sm]="activeView() !== 'items'">
                    <i class="bi bi-box-seam"></i>
                    Inventory
                </button>
                <button (click)="setView('suggestions')"
                    class="px-4 py-2.5 rounded-xl text-sm font-medium transition-all flex items-center gap-2"
                    [class.bg-indigo-600]="activeView() === 'suggestions'"
                    [class.text-white]="activeView() === 'suggestions'"
                    [class.bg-white]="activeView() !== 'suggestions'"
                    [class.text-gray-700]="activeView() !== 'suggestions'"
                    [class.border]="activeView() !== 'suggestions'"
                    [class.border-gray-200]="activeView() !== 'suggestions'"
                    [class.shadow-sm]="activeView() !== 'suggestions'">
                    <i class="bi bi-cart-plus"></i>
                    PO Suggestions
                    @if (stats().poSuggestions > 0) {
                    <span class="bg-green-500 text-white text-xs px-1.5 py-0.5 rounded-full">{{ stats().poSuggestions
                        }}</span>
                    }
                </button>
            </div>
        </div>

        <!-- DASHBOARD VIEW -->
        @if (activeView() === 'dashboard') {
        <div class="space-y-6 animate-fade-in">
            <!-- Critical Stats -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="bg-red-50 border border-red-100 p-5 rounded-2xl">
                    <div class="flex items-start justify-between">
                        <div>
                            <p class="text-xs font-medium text-red-600 uppercase tracking-wider mb-1">Critical Stock</p>
                            <p class="text-3xl font-bold text-red-700">{{ stats().criticalCount }}</p>
                        </div>
                        <div class="w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center">
                            <i class="bi bi-exclamation-octagon text-red-600 text-xl"></i>
                        </div>
                    </div>
                    <p class="text-sm text-red-600 mt-2">Immediate action required</p>
                </div>

                <div class="bg-orange-50 border border-orange-100 p-5 rounded-2xl">
                    <div class="flex items-start justify-between">
                        <div>
                            <p class="text-xs font-medium text-orange-600 uppercase tracking-wider mb-1">Low Stock</p>
                            <p class="text-3xl font-bold text-orange-700">{{ stats().lowCount }}</p>
                        </div>
                        <div class="w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center">
                            <i class="bi bi-exclamation-triangle text-orange-600 text-xl"></i>
                        </div>
                    </div>
                    <p class="text-sm text-orange-600 mt-2">Reorder recommended</p>
                </div>

                <div class="bg-blue-50 border border-blue-100 p-5 rounded-2xl">
                    <div class="flex items-start justify-between">
                        <div>
                            <p class="text-xs font-medium text-blue-600 uppercase tracking-wider mb-1">Total Shortage
                            </p>
                            <p class="text-3xl font-bold text-blue-700">{{ formatCurrency(stats().totalShortageValue) }}
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center">
                            <i class="bi bi-currency-dollar text-blue-600 text-xl"></i>
                        </div>
                    </div>
                    <p class="text-sm text-blue-600 mt-2">Estimated reorder value</p>
                </div>

                <div class="bg-green-50 border border-green-100 p-5 rounded-2xl">
                    <div class="flex items-start justify-between">
                        <div>
                            <p class="text-xs font-medium text-green-600 uppercase tracking-wider mb-1">Avg Days to
                                Stockout</p>
                            <p class="text-3xl font-bold text-green-700">{{ stats().avgDaysUntilStockout |
                                number:'1.1-1' }}</p>
                        </div>
                        <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center">
                            <i class="bi bi-calendar-event text-green-600 text-xl"></i>
                        </div>
                    </div>
                    <p class="text-sm text-green-600 mt-2">Across critical items</p>
                </div>
            </div>

            <!-- Inventory Distribution -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Stock Status Chart -->
                <div class="bg-white p-6 rounded-2xl border border-gray-100 shadow-sm">
                    <h3 class="font-semibold text-gray-900 mb-6">Stock Status Distribution</h3>
                    <div class="space-y-4">
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm text-gray-600 flex items-center gap-2">
                                    <span class="w-3 h-3 rounded-full bg-red-500"></span>
                                    Critical
                                </span>
                                <span class="font-semibold text-gray-900">{{ stats().criticalCount }}</span>
                            </div>
                            <div class="h-2 bg-gray-100 rounded-full overflow-hidden">
                                <div class="h-full bg-red-500 rounded-full"
                                    [style.width.%]="(stats().criticalCount / stats().totalItems) * 100"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm text-gray-600 flex items-center gap-2">
                                    <span class="w-3 h-3 rounded-full bg-orange-500"></span>
                                    Low Stock
                                </span>
                                <span class="font-semibold text-gray-900">{{ stats().lowCount }}</span>
                            </div>
                            <div class="h-2 bg-gray-100 rounded-full overflow-hidden">
                                <div class="h-full bg-orange-500 rounded-full"
                                    [style.width.%]="(stats().lowCount / stats().totalItems) * 100"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm text-gray-600 flex items-center gap-2">
                                    <span class="w-3 h-3 rounded-full bg-green-500"></span>
                                    Adequate
                                </span>
                                <span class="font-semibold text-gray-900">{{ stats().adequateCount }}</span>
                            </div>
                            <div class="h-2 bg-gray-100 rounded-full overflow-hidden">
                                <div class="h-full bg-green-500 rounded-full"
                                    [style.width.%]="(stats().adequateCount / stats().totalItems) * 100"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm text-gray-600 flex items-center gap-2">
                                    <span class="w-3 h-3 rounded-full bg-blue-500"></span>
                                    Excess
                                </span>
                                <span class="font-semibold text-gray-900">{{ stats().excessCount }}</span>
                            </div>
                            <div class="h-2 bg-gray-100 rounded-full overflow-hidden">
                                <div class="h-full bg-blue-500 rounded-full"
                                    [style.width.%]="(stats().excessCount / stats().totalItems) * 100"></div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-6 pt-4 border-t border-gray-100">
                        <p class="text-sm text-gray-500">Total SKUs monitored: <strong class="text-gray-900">{{
                                stats().totalItems }}</strong></p>
                    </div>
                </div>

                <!-- Recent Critical Alerts -->
                <div class="bg-white p-6 rounded-2xl border border-gray-100 shadow-sm lg:col-span-2">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="font-semibold text-gray-900">Critical Alerts Requiring Action</h3>
                        <button (click)="setView('alerts')"
                            class="text-sm text-indigo-600 hover:text-indigo-700 font-medium">
                            View All <i class="bi bi-arrow-right"></i>
                        </button>
                    </div>

                    <div class="space-y-3">
                        @for (alert of criticalAlerts().slice(0, 5); track alert.id) {
                        <div class="p-4 bg-red-50 border border-red-100 rounded-xl flex items-center justify-between hover:bg-red-100 transition-colors cursor-pointer"
                            (click)="acknowledgeAlert(alert)">
                            <div class="flex items-center gap-4">
                                <img [src]="alert.product.image" class="w-12 h-12 rounded-lg object-cover bg-white">
                                <div>
                                    <p class="font-semibold text-gray-900">{{ alert.product.name }}</p>
                                    <p class="text-sm text-gray-600">{{ alert.warehouse.name }} • {{ alert.product.sku
                                        }}</p>
                                    <p class="text-xs text-red-600 mt-1">
                                        <i class="bi bi-clock-history mr-1"></i>
                                        {{ alert.daysUntilStockout }} days until stockout
                                    </p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-lg font-bold text-red-700">{{ alert.currentStock }} <span
                                        class="text-sm font-normal text-gray-500">/ {{ alert.reorderPoint }} min</span>
                                </p>
                                <p class="text-xs text-gray-500">Suggested: {{ alert.suggestedOrderQty }} units</p>
                            </div>
                        </div>
                        } @empty {
                        <div class="text-center py-8 text-gray-500">
                            <i class="bi bi-check-circle text-3xl text-green-500 mb-2"></i>
                            <p>No critical alerts at this time</p>
                        </div>
                        }
                    </div>
                </div>
            </div>

            <!-- PO Suggestions Preview -->
            @if (poSuggestions().length > 0) {
            <div class="bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden">
                <div class="p-6 border-b border-gray-100 flex items-center justify-between">
                    <div>
                        <h3 class="font-semibold text-gray-900">Purchase Order Suggestions</h3>
                        <p class="text-sm text-gray-500 mt-1">Consolidated orders by supplier to minimize shipping costs
                        </p>
                    </div>
                    <button (click)="setView('suggestions')"
                        class="px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors">
                        Review All
                    </button>
                </div>
                <div class="divide-y divide-gray-100">
                    @for (suggestion of poSuggestions().slice(0, 3); track suggestion.id) {
                    <div class="p-4 flex items-center justify-between hover:bg-gray-50/50 transition-colors">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center">
                                <i class="bi bi-shop text-indigo-600 text-xl"></i>
                            </div>
                            <div>
                                <p class="font-semibold text-gray-900">{{ suggestion.supplier.name }}</p>
                                <p class="text-sm text-gray-600">{{ suggestion.totalItems }} items • {{
                                    suggestion.totalQty }} units total</p>
                                @if (suggestion.consolidationOpportunities > 0) {
                                <span class="text-xs text-green-600 font-medium">
                                    <i class="bi bi-lightning-charge mr-1"></i>
                                    {{ suggestion.consolidationOpportunities }} consolidation opportunities
                                </span>
                                }
                            </div>
                        </div>
                        <div class="flex items-center gap-6">
                            <div class="text-right">
                                <p class="text-lg font-bold text-gray-900">{{ formatCurrency(suggestion.total) }}</p>
                                <p class="text-xs text-gray-500">Est. delivery: {{
                                    formatDate(suggestion.estimatedDeliveryDate) }}</p>
                            </div>
                            <button (click)="createPOFromSuggestion(suggestion)"
                                class="px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 transition-colors">
                                Create PO
                            </button>
                        </div>
                    </div>
                    }
                </div>
            </div>
            }
        </div>
        }

        <!-- ALERTS VIEW -->
        @if (activeView() === 'alerts') {
        <div class="space-y-6 animate-fade-in">
            <!-- Filters -->
            <div class="bg-white rounded-2xl p-5 border border-gray-100 shadow-sm space-y-4">
                <div class="flex flex-col lg:flex-row gap-4">
                    <div class="relative flex-1">
                        <i class="bi bi-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
                        <input type="text" [(ngModel)]="searchQuery" placeholder="Search by product name, SKU..."
                            class="w-full pl-11 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all">
                    </div>

                    <div class="flex flex-wrap gap-2">
                        <select [(ngModel)]="filterSeverity"
                            class="px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 text-sm min-w-[140px]">
                            <option value="all">All Severities</option>
                            <option value="critical">Critical</option>
                            <option value="warning">Warning</option>
                            <option value="info">Info</option>
                        </select>

                        <select [(ngModel)]="filterWarehouse"
                            class="px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 text-sm min-w-[140px]">
                            <option value="all">All Warehouses</option>
                            @for (wh of warehouses(); track wh.id) {
                            <option [value]="wh.id">{{ wh.name }}</option>
                            }
                        </select>

                        <select [(ngModel)]="filterStatus"
                            class="px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 text-sm min-w-[140px]">
                            <option value="active">Active</option>
                            <option value="acknowledged">Acknowledged</option>
                            <option value="resolved">Resolved</option>
                            <option value="all">All Status</option>
                        </select>
                    </div>
                </div>

                <div class="flex items-center justify-between pt-3 border-t border-gray-100">
                    <label class="flex items-center gap-2 text-sm text-gray-700 cursor-pointer">
                        <input type="checkbox" [(ngModel)]="showOnlyUnread"
                            class="w-4 h-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                        Show only unread alerts
                    </label>

                    @if (selectedAlertIds().length > 0) {
                    <div class="flex items-center gap-2">
                        <span class="text-sm text-gray-600">{{ selectedAlertIds().length }} selected</span>
                        <button (click)="acknowledgeSelected()"
                            class="px-3 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors">
                            Acknowledge Selected
                        </button>
                    </div>
                    }
                </div>
            </div>

            <!-- Alerts List -->
            <div class="bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50/50 border-b border-gray-100">
                            <tr>
                                <th class="px-4 py-4 text-left w-12">
                                    <input type="checkbox"
                                        [checked]="selectedAlertIds().length === filteredAlerts().length && filteredAlerts().length > 0"
                                        (change)="setSelectedAlterIds($event.target.checked)"
                                        class="w-4 h-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                                </th>
                                <th class="px-4 py-4 text-left text-xs font-semibold text-gray-500 uppercase">Product
                                </th>
                                <th class="px-4 py-4 text-left text-xs font-semibold text-gray-500 uppercase">Warehouse
                                </th>
                                <th class="px-4 py-4 text-center text-xs font-semibold text-gray-500 uppercase">Severity
                                </th>
                                <th class="px-4 py-4 text-right text-xs font-semibold text-gray-500 uppercase">Current /
                                    Min</th>
                                <th class="px-4 py-4 text-center text-xs font-semibold text-gray-500 uppercase">Days
                                    Left</th>
                                <th class="px-4 py-4 text-right text-xs font-semibold text-gray-500 uppercase">Suggested
                                    Qty</th>
                                <th class="px-4 py-4 text-right text-xs font-semibold text-gray-500 uppercase">Est. Cost
                                </th>
                                <th class="px-4 py-4 text-center text-xs font-semibold text-gray-500 uppercase">Status
                                </th>
                                <th class="px-4 py-4 text-center text-xs font-semibold text-gray-500 uppercase">Actions
                                </th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-100">
                            @for (alert of filteredAlerts(); track alert.id) {
                            <tr class="hover:bg-gray-50/50 transition-colors"
                                [class.bg-red-50]="!alert.isRead && alert.severity === 'critical'">
                                <td class="px-4 py-4">
                                    <input type="checkbox" [checked]="selectedAlertIds().includes(alert.id)"
                                        (change)="toggleAlertSelection(alert.id); $event.stopPropagation()"
                                        class="w-4 h-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                                </td>
                                <td class="px-4 py-4">
                                    <div class="flex items-center gap-3">
                                        <img [src]="alert.product.image"
                                            class="w-10 h-10 rounded-lg object-cover bg-gray-100">
                                        <div>
                                            <p class="font-medium text-gray-900 text-sm">{{ alert.product.name }}</p>
                                            <p class="text-xs text-gray-500">{{ alert.product.sku }}</p>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-4 py-4">
                                    <span class="text-sm text-gray-700">{{ alert.warehouse.code }}</span>
                                    <p class="text-xs text-gray-500">{{ alert.warehouse.name }}</p>
                                </td>
                                <td class="px-4 py-4 text-center">
                                    <span
                                        class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium border"
                                        [class]="getSeverityColor(alert.severity)">
                                        <span class="w-1.5 h-1.5 rounded-full mr-1.5"
                                            [class.bg-red-500]="alert.severity === 'critical'"
                                            [class.bg-orange-500]="alert.severity === 'warning'"
                                            [class.bg-blue-500]="alert.severity === 'info'">
                                        </span>
                                        {{ alert.severity | titlecase }}
                                    </span>
                                </td>
                                <td class="px-4 py-4 text-right">
                                    <div class="flex items-center justify-end gap-2">
                                        <span class="text-lg font-bold"
                                            [class.text-red-600]="alert.currentStock < alert.reorderPoint * 0.5"
                                            [class.text-orange-600]="alert.currentStock >= alert.reorderPoint * 0.5 && alert.currentStock < alert.reorderPoint"
                                            [class.text-gray-900]="alert.currentStock >= alert.reorderPoint">
                                            {{ alert.currentStock }}
                                        </span>
                                        <span class="text-gray-400">/</span>
                                        <span class="text-sm text-gray-500">{{ alert.reorderPoint }}</span>
                                    </div>
                                    <div class="w-24 h-1.5 bg-gray-200 rounded-full mt-1 ml-auto overflow-hidden">
                                        <div class="h-full rounded-full transition-all"
                                            [class]="getProgressColor((alert.currentStock / alert.reorderPoint) * 100)"
                                            [style.width.%]="Math.min(100, (alert.currentStock / alert.reorderPoint) * 100)">
                                        </div>
                                    </div>
                                </td>
                                <td class="px-4 py-4 text-center">
                                    <span class="text-sm font-medium" [class]="getDaysColor(alert.daysUntilStockout)">
                                        @if (alert.daysUntilStockout <= 0) { <i
                                            class="bi bi-exclamation-triangle-fill mr-1"></i>
                                            Stockout!
                                            } @else {
                                            {{ alert.daysUntilStockout }} days
                                            }
                                    </span>
                                </td>
                                <td class="px-4 py-4 text-right">
                                    <span class="text-sm font-medium text-gray-900">{{ alert.suggestedOrderQty }}</span>
                                    <p class="text-xs text-gray-500">{{ alert.suggestedSupplier?.code || 'N/A' }}</p>
                                </td>
                                <td class="px-4 py-4 text-right">
                                    <span class="text-sm font-medium text-gray-900">{{
                                        formatCurrency(alert.estimatedCost) }}</span>
                                </td>
                                <td class="px-4 py-4 text-center">
                                    @if (alert.resolvedAt) {
                                    <span class="text-xs text-green-600 font-medium">Resolved</span>
                                    } @else if (alert.acknowledgedAt) {
                                    <span class="text-xs text-blue-600 font-medium">Acknowledged</span>
                                    } @else {
                                    <span class="text-xs text-orange-600 font-medium">New</span>
                                    }
                                </td>
                                <td class="px-4 py-4">
                                    <div class="flex items-center justify-center gap-1">
                                        @if (!alert.acknowledgedAt && !alert.resolvedAt) {
                                        <button (click)="acknowledgeAlert(alert)"
                                            class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"
                                            title="Acknowledge">
                                            <i class="bi bi-check-lg"></i>
                                        </button>
                                        }
                                        @if (!alert.resolvedAt) {
                                        <button (click)="resolveAlert(alert)"
                                            class="p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors"
                                            title="Resolve">
                                            <i class="bi bi-check-all"></i>
                                        </button>
                                        }
                                        <button (click)="markAsRead(alert)"
                                            class="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"
                                            title="Mark as read">
                                            <i class="bi bi-eye"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            } @empty {
                            <tr>
                                <td colspan="10" class="px-6 py-12 text-center">
                                    <div class="flex flex-col items-center">
                                        <div
                                            class="w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mb-4">
                                            <i class="bi bi-bell-slash text-gray-400 text-2xl"></i>
                                        </div>
                                        <h3 class="text-lg font-medium text-gray-900 mb-1">No alerts found</h3>
                                        <p class="text-gray-500">All items are at healthy stock levels</p>
                                    </div>
                                </td>
                            </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        }

        <!-- INVENTORY ITEMS VIEW -->
        @if (activeView() === 'items') {
        <div class="space-y-6 animate-fade-in">
            <!-- Filters -->
            <div class="bg-white rounded-2xl p-5 border border-gray-100 shadow-sm flex flex-col lg:flex-row gap-4">
                <div class="relative flex-1">
                    <i class="bi bi-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
                    <input type="text" [(ngModel)]="searchQuery" placeholder="Search products..."
                        class="w-full pl-11 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all">
                </div>

                <div class="flex flex-wrap gap-2">
                    <select [(ngModel)]="filterWarehouse"
                        class="px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 text-sm min-w-[140px]">
                        <option value="all">All Warehouses</option>
                        @for (wh of warehouses(); track wh.id) {
                        <option [value]="wh.id">{{ wh.name }}</option>
                        }
                    </select>

                    <select [(ngModel)]="filterCategory"
                        class="px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 text-sm min-w-[140px]">
                        <option value="all">All Categories</option>
                        @for (cat of categories(); track cat) {
                        <option [value]="cat">{{ cat }}</option>
                        }
                    </select>

                    <button (click)="openBulkEdit()"
                        class="px-4 py-3 bg-white border border-gray-200 text-gray-700 rounded-xl text-sm font-medium hover:bg-gray-50 transition-all flex items-center gap-2">
                        <i class="bi bi-sliders"></i>
                        Bulk Edit
                    </button>
                </div>
            </div>

            <!-- Items Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
                @for (item of filteredInventory(); track item.id) {
                <div class="bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden hover:shadow-md transition-all"
                    [class]="getStockStatusBg(item.stockStatus)">
                    <!-- Header -->
                    <div class="p-5 border-b border-gray-100/50">
                        <div class="flex items-start justify-between mb-3">
                            <div class="flex items-center gap-3">
                                <img [src]="item.product.image" class="w-12 h-12 rounded-xl object-cover bg-gray-100">
                                <div>
                                    <h3 class="font-semibold text-gray-900 line-clamp-1">{{ item.product.name }}</h3>
                                    <p class="text-sm text-gray-500">{{ item.product.sku }}</p>
                                </div>
                            </div>
                            <span class="px-2 py-1 rounded-lg text-xs font-medium text-white"
                                [class.bg-red-500]="item.stockStatus === 'critical'"
                                [class.bg-orange-500]="item.stockStatus === 'low'"
                                [class.bg-green-500]="item.stockStatus === 'adequate'"
                                [class.bg-blue-500]="item.stockStatus === 'excess'">
                                {{ getStockStatusLabel(item.stockStatus) }}
                            </span>
                        </div>

                        <div class="flex items-center gap-2 text-sm text-gray-600">
                            <i class="bi bi-geo-alt text-gray-400"></i>
                            {{ item.warehouse.name }}
                            @if (item.binLocation) {
                            <span class="text-gray-400">•</span>
                            <span class="font-mono text-xs bg-gray-100 px-2 py-0.5 rounded">{{ item.binLocation
                                }}</span>
                            }
                        </div>
                    </div>

                    <!-- Stock Levels -->
                    <div class="p-5 space-y-4">
                        <!-- Main Stock Bar -->
                        <div>
                            <div class="flex items-center justify-between text-sm mb-2">
                                <span class="text-gray-600">Stock Level</span>
                                <span class="font-semibold" [class]="getDaysColor(item.daysOfSupply)">
                                    {{ item.onHandQty }} units ({{ item.daysOfSupply | number:'1.1-1' }} days)
                                </span>
                            </div>
                            <div class="h-3 bg-gray-200 rounded-full overflow-hidden">
                                <div class="h-full rounded-full transition-all duration-500"
                                    [class]="getStockStatusColor(item.stockStatus)"
                                    [style.width.%]="calculateStockPercentage(item)">
                                </div>
                            </div>
                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                <span>0</span>
                                <span>Reorder: {{ item.reorderPoint }}</span>
                                <span>Max: {{ item.maxStockLevel }}</span>
                            </div>
                        </div>

                        <!-- Stats Grid -->
                        <div class="grid grid-cols-3 gap-3 pt-3 border-t border-gray-100/50">
                            <div class="text-center">
                                <p class="text-xs text-gray-500 mb-1">Available</p>
                                <p class="font-semibold text-gray-900">{{ item.availableQty }}</p>
                            </div>
                            <div class="text-center border-x border-gray-100/50">
                                <p class="text-xs text-gray-500 mb-1">Reserved</p>
                                <p class="font-semibold text-orange-600">{{ item.reservedQty }}</p>
                            </div>
                            <div class="text-center">
                                <p class="text-xs text-gray-500 mb-1">Incoming</p>
                                <p class="font-semibold text-blue-600">{{ item.incomingQty }}</p>
                            </div>
                        </div>

                        <!-- Reorder Info -->
                        <div class="bg-white/50 rounded-lg p-3 space-y-2">
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">Reorder Point</span>
                                <span class="font-medium text-gray-900">{{ item.reorderPoint }}</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">Reorder Qty</span>
                                <span class="font-medium text-gray-900">{{ item.reorderQty }}</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">Safety Stock</span>
                                <span class="font-medium text-gray-900">{{ item.safetyStock }}</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">Avg Daily Use</span>
                                <span class="font-medium text-gray-900">{{ item.avgDailyUsage | number:'1.1-2' }}</span>
                            </div>
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="px-5 py-3 bg-gray-50/50 border-t border-gray-100/50 flex items-center justify-between">
                        <div class="flex items-center gap-2">
                            @if (item.alertConfig?.enabled) {
                            <span class="text-xs text-green-600 flex items-center gap-1">
                                <i class="bi bi-bell-fill"></i>
                                Alerts on
                            </span>
                            }
                        </div>
                        <button (click)="openItemSettings(item)"
                            class="px-3 py-1.5 text-sm font-medium text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors">
                            <i class="bi bi-gear mr-1"></i>
                            Settings
                        </button>
                    </div>
                </div>
                }
            </div>
        </div>
        }

        <!-- PO SUGGESTIONS VIEW -->
        @if (activeView() === 'suggestions') {
        <div class="space-y-6 animate-fade-in">
            <div class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-2xl p-6">
                <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                    <div>
                        <h2 class="text-xl font-bold mb-1">Purchase Order Suggestions</h2>
                        <p class="text-indigo-100">AI-powered consolidation recommendations based on low stock alerts
                        </p>
                    </div>
                    <div class="flex gap-4 text-center">
                        <div>
                            <p class="text-2xl font-bold">{{ poSuggestions().length }}</p>
                            <p class="text-xs text-indigo-200">Suggestions</p>
                        </div>
                        <div class="w-px bg-white/20"></div>
                        <div>
                            <p class="text-2xl font-bold">{{ formatCurrency(stats().totalSuggestedValue) }}</p>
                            <p class="text-xs text-indigo-200">Total Value</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Suggestions List -->
            <div class="space-y-4">
                @for (suggestion of poSuggestions(); track suggestion.id) {
                <div class="bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden">
                    <!-- Header -->
                    <div class="p-6 border-b border-gray-100 bg-gray-50/30">
                        <div class="flex flex-col lg:flex-row lg:items-center justify-between gap-4">
                            <div class="flex items-center gap-4">
                                <div class="w-14 h-14 bg-indigo-100 rounded-2xl flex items-center justify-center">
                                    <i class="bi bi-shop text-indigo-600 text-2xl"></i>
                                </div>
                                <div>
                                    <h3 class="text-lg font-bold text-gray-900">{{ suggestion.supplier.name }}</h3>
                                    <div class="flex items-center gap-3 text-sm text-gray-600 mt-1">
                                        <span class="flex items-center gap-1">
                                            <i class="bi bi-star-fill text-yellow-400"></i>
                                            {{ suggestion.supplier.rating | titlecase }}
                                        </span>
                                        <span>•</span>
                                        <span>{{ suggestion.supplier.leadTimeDays }} day lead time</span>
                                        <span>•</span>
                                        <span>Min order: {{ formatCurrency(suggestion.supplier.minOrderValue) }}</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center gap-4">
                                <div class="text-right">
                                    <p class="text-2xl font-bold text-gray-900">{{ formatCurrency(suggestion.total) }}
                                    </p>
                                    <p class="text-xs text-gray-500">
                                        {{ suggestion.subtotal | currency }} + {{ suggestion.tax | currency }} tax + {{
                                        suggestion.shipping | currency }} shipping
                                    </p>
                                </div>
                                <button (click)="createPOFromSuggestion(suggestion)"
                                    class="px-6 py-3 bg-green-600 text-white rounded-xl font-medium hover:bg-green-700 transition-all shadow-lg shadow-green-200 flex items-center gap-2">
                                    <i class="bi bi-cart-plus"></i>
                                    Create PO
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Items -->
                    <div class="divide-y divide-gray-100">
                        @for (item of suggestion.items; track item.product.id) {
                        <div class="p-4 flex items-center justify-between hover:bg-gray-50/50 transition-colors"
                            [class.bg-red-50]="item.urgency === 'critical'">
                            <div class="flex items-center gap-4">
                                <img [src]="item.product.image" class="w-14 h-14 rounded-xl object-cover bg-gray-100">
                                <div>
                                    <div class="flex items-center gap-2">
                                        <p class="font-semibold text-gray-900">{{ item.product.name }}</p>
                                        @if (item.urgency === 'critical') {
                                        <span
                                            class="px-2 py-0.5 bg-red-100 text-red-700 text-xs rounded-full">CRITICAL</span>
                                        }
                                    </div>
                                    <p class="text-sm text-gray-500">{{ item.product.sku }} • {{ item.product.category
                                        }}</p>
                                    <p class="text-xs text-gray-600 mt-1">
                                        Current: <strong>{{ item.currentStock }}</strong> |
                                        Reorder Point: <strong>{{ item.reorderPoint }}</strong>
                                        @if (item.notes) {
                                        <span class="text-red-600 ml-2"><i
                                                class="bi bi-exclamation-triangle mr-1"></i>{{ item.notes }}</span>
                                        }
                                    </p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-lg font-bold text-gray-900">{{ item.suggestedQty }} <span
                                        class="text-sm font-normal text-gray-500">units</span></p>
                                <p class="text-sm text-gray-600">{{ item.unitCost | currency }} each</p>
                                <p class="font-medium text-gray-900">{{ item.lineTotal | currency }}</p>
                            </div>
                        </div>
                        }
                    </div>

                    <!-- Footer -->
                    <div class="px-6 py-4 bg-gray-50/50 border-t border-gray-100 flex items-center justify-between">
                        <div class="flex items-center gap-4 text-sm text-gray-600">
                            <span><i class="bi bi-box mr-1"></i>{{ suggestion.totalItems }} items</span>
                            <span><i class="bi bi-layers mr-1"></i>{{ suggestion.totalQty }} units total</span>
                            @if (suggestion.consolidationOpportunities > 0) {
                            <span class="text-green-600">
                                <i class="bi bi-lightning-charge mr-1"></i>
                                {{ suggestion.consolidationOpportunities }} items consolidated
                            </span>
                            }
                        </div>
                        <div class="text-sm text-gray-600">
                            Est. delivery: <strong class="text-gray-900">{{ formatDate(suggestion.estimatedDeliveryDate)
                                }}</strong>
                        </div>
                    </div>
                </div>
                } @empty {
                <div class="bg-white rounded-2xl p-12 border border-gray-100 shadow-sm text-center">
                    <div class="w-20 h-20 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4">
                        <i class="bi bi-check-circle text-green-600 text-3xl"></i>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">No Purchase Suggestions</h3>
                    <p class="text-gray-500">All inventory levels are healthy. No purchase orders needed at this time.
                    </p>
                </div>
                }
            </div>
        </div>
        }

    </div>
</div>

<!-- Item Settings Modal -->
@if (showSettingsModal()) {
<div class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in">
    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-hidden animate-slide-up">
        <div class="px-6 py-4 border-b border-gray-100 flex items-center justify-between bg-gray-50/50">
            <h2 class="text-lg font-semibold text-gray-900">Reorder Settings</h2>
            <button (click)="showSettingsModal.set(false)"
                class="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors">
                <i class="bi bi-x-lg"></i>
            </button>
        </div>

        @if (selectedItem(); as item) {
        <div class="p-6 overflow-y-auto max-h-[60vh]">
            <div class="flex items-center gap-4 mb-6 p-4 bg-gray-50 rounded-xl">
                <img [src]="item.product.image" class="w-16 h-16 rounded-xl object-cover bg-gray-100">
                <div>
                    <p class="font-semibold text-gray-900">{{ item.product.name }}</p>
                    <p class="text-sm text-gray-500">{{ item.product.sku }} • {{ item.warehouse.name }}</p>
                </div>
            </div>

            <form [formGroup]="settingsForm" class="space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Reorder Point</label>
                        <input type="number" formControlName="reorderPoint" min="0"
                            class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all text-center">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Reorder Qty</label>
                        <input type="number" formControlName="reorderQty" min="1"
                            class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all text-center">
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Safety Stock</label>
                        <input type="number" formControlName="safetyStock" min="0"
                            class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all text-center">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Max Stock Level</label>
                        <input type="number" formControlName="maxStockLevel" min="1"
                            class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all text-center">
                    </div>
                </div>

                <div class="pt-4 border-t border-gray-100">
                    <p class="text-sm font-medium text-gray-700 mb-3">Alert Configuration</p>
                    <div class="space-y-3">
                        <label class="flex items-center gap-3">
                            <input type="checkbox" formControlName="notifyBuyers"
                                class="w-4 h-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                            <span class="text-sm text-gray-700">Notify buyers when low stock</span>
                        </label>
                        <label class="flex items-center gap-3">
                            <input type="checkbox" formControlName="notifyManagers"
                                class="w-4 h-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                            <span class="text-sm text-gray-700">Notify managers for critical stock</span>
                        </label>
                        <label class="flex items-center gap-3">
                            <input type="checkbox" formControlName="autoCreatePO"
                                class="w-4 h-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                            <span class="text-sm text-gray-700">Auto-create PO suggestions</span>
                        </label>
                    </div>
                </div>
            </form>
        </div>

        <div class="px-6 py-4 border-t border-gray-100 flex items-center justify-end gap-3 bg-gray-50/50">
            <button (click)="showSettingsModal.set(false)"
                class="px-4 py-2.5 text-gray-700 font-medium hover:bg-gray-100 rounded-xl transition-colors">
                Cancel
            </button>
            <button (click)="saveItemSettings()"
                class="px-6 py-2.5 bg-indigo-600 text-white font-medium rounded-xl hover:bg-indigo-700 transition-all shadow-lg shadow-indigo-200">
                Save Settings
            </button>
        </div>
        }
    </div>
</div>
}

<!-- Create PO Modal -->
@if (showPOModal()) {
<div class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in">
    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden animate-slide-up">
        <div class="px-6 py-4 border-b border-gray-100 flex items-center justify-between bg-gray-50/50">
            <h2 class="text-lg font-semibold text-gray-900">Create Purchase Order</h2>
            <button (click)="showPOModal.set(false)"
                class="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors">
                <i class="bi bi-x-lg"></i>
            </button>
        </div>

        @if (selectedSuggestion(); as suggestion) {
        <div class="p-6 overflow-y-auto max-h-[60vh]">
            <div class="flex items-center gap-4 mb-6 p-4 bg-green-50 rounded-xl border border-green-100">
                <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center">
                    <i class="bi bi-shop text-green-600 text-xl"></i>
                </div>
                <div>
                    <p class="font-semibold text-gray-900">{{ suggestion.supplier.name }}</p>
                    <p class="text-sm text-gray-600">{{ suggestion.totalItems }} items • {{
                        formatCurrency(suggestion.total) }}</p>
                </div>
            </div>

            <form [formGroup]="poForm" class="space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Order Date</label>
                        <input type="date" formControlName="orderDate"
                            class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Expected Delivery</label>
                        <input type="date" formControlName="expectedDelivery"
                            class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Notes for Supplier</label>
                    <textarea formControlName="notes" rows="3"
                        placeholder="Special instructions, delivery requirements, etc..."
                        class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all resize-none"></textarea>
                </div>

                <div class="bg-gray-50 rounded-xl p-4">
                    <h4 class="font-medium text-gray-900 mb-3">Order Summary</h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-600">Subtotal</span>
                            <span class="font-medium">{{ suggestion.subtotal | currency }}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Tax (8%)</span>
                            <span class="font-medium">{{ suggestion.tax | currency }}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Shipping</span>
                            <span class="font-medium">{{ suggestion.shipping | currency }}</span>
                        </div>
                        <div class="border-t border-gray-200 pt-2 flex justify-between text-base font-semibold">
                            <span class="text-gray-900">Total</span>
                            <span class="text-gray-900">{{ suggestion.total | currency }}</span>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <div class="px-6 py-4 border-t border-gray-100 flex items-center justify-end gap-3 bg-gray-50/50">
            <button (click)="showPOModal.set(false)"
                class="px-4 py-2.5 text-gray-700 font-medium hover:bg-gray-100 rounded-xl transition-colors">
                Cancel
            </button>
            <button (click)="confirmPO()"
                class="px-6 py-2.5 bg-green-600 text-white font-medium rounded-xl hover:bg-green-700 transition-all shadow-lg shadow-green-200">
                <i class="bi bi-cart-check mr-2"></i>
                Create Purchase Order
            </button>
        </div>
        }
    </div>
</div>
}

<!-- Acknowledge Modal -->
@if (showAcknowledgeModal()) {
<div class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in">
    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 animate-slide-up text-center">
        <div class="w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4">
            <i class="bi bi-check-circle text-blue-600 text-2xl"></i>
        </div>
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Acknowledge Alert?</h3>
        <p class="text-gray-500 mb-6">
            Mark alert for <strong>{{ selectedAlert()?.product?.name }}</strong> as acknowledged?
            This will notify the team that you're aware of the low stock situation.
        </p>
        <div class="flex gap-3 justify-center">
            <button (click)="showAcknowledgeModal.set(false)"
                class="px-4 py-2.5 text-gray-700 font-medium hover:bg-gray-100 rounded-xl transition-colors">
                Cancel
            </button>
            <button (click)="confirmAcknowledge()"
                class="px-6 py-2.5 bg-blue-600 text-white font-medium rounded-xl hover:bg-blue-700 transition-all shadow-lg shadow-blue-200">
                Acknowledge
            </button>
        </div>
    </div>
</div>
}

<!-- Resolve Modal -->
@if (showResolveModal()) {
<div class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in">
    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 animate-slide-up text-center">
        <div class="w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4">
            <i class="bi bi-check-all text-green-600 text-2xl"></i>
        </div>
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Resolve Alert?</h3>
        <p class="text-gray-500 mb-6">
            Mark alert for <strong>{{ selectedAlert()?.product?.name }}</strong> as resolved?
            Use this when a purchase order has been created or stock has been replenished.
        </p>
        <div class="flex gap-3 justify-center">
            <button (click)="showResolveModal.set(false)"
                class="px-4 py-2.5 text-gray-700 font-medium hover:bg-gray-100 rounded-xl transition-colors">
                Cancel
            </button>
            <button (click)="confirmResolve()"
                class="px-6 py-2.5 bg-green-600 text-white font-medium rounded-xl hover:bg-green-700 transition-all shadow-lg shadow-green-200">
                Resolve Alert
            </button>
        </div>
    </div>
</div>
}

<!-- Bulk Edit Modal -->
@if (showBulkEditModal()) {
<div class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in">
    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md animate-slide-up">
        <div class="px-6 py-4 border-b border-gray-100 flex items-center justify-between bg-gray-50/50">
            <h2 class="text-lg font-semibold text-gray-900">Bulk Edit Settings</h2>
            <button (click)="showBulkEditModal.set(false)"
                class="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors">
                <i class="bi bi-x-lg"></i>
            </button>
        </div>

        <form [formGroup]="bulkEditForm" class="p-6 space-y-4">
            <p class="text-sm text-gray-600 mb-4">Leave fields empty to keep existing values</p>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Reorder Point</label>
                <input type="number" formControlName="reorderPoint" min="0" placeholder="Keep current"
                    class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all">
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Reorder Quantity</label>
                <input type="number" formControlName="reorderQty" min="1" placeholder="Keep current"
                    class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all">
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Safety Stock</label>
                <input type="number" formControlName="safetyStock" min="0" placeholder="Keep current"
                    class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all">
            </div>

            <label class="flex items-center gap-3 pt-4 border-t border-gray-100">
                <input type="checkbox" formControlName="applyToAll"
                    class="w-4 h-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                <span class="text-sm text-gray-700">Apply to all filtered items ({{ filteredInventory().length }}
                    items)</span>
            </label>
        </form>

        <div class="px-6 py-4 border-t border-gray-100 flex items-center justify-end gap-3 bg-gray-50/50">
            <button (click)="showBulkEditModal.set(false)"
                class="px-4 py-2.5 text-gray-700 font-medium hover:bg-gray-100 rounded-xl transition-colors">
                Cancel
            </button>
            <button (click)="applyBulkEdit()"
                class="px-6 py-2.5 bg-indigo-600 text-white font-medium rounded-xl hover:bg-indigo-700 transition-all shadow-lg shadow-indigo-200">
                Apply Changes
            </button>
        </div>
    </div>
</div>
}